# afi-artifacts — Agent Instructions

**afi-artifacts** is the build artifacts and compiled outputs repository for AFI Protocol. It contains repro bundles, compiled binaries, and deterministic build outputs for reproducibility and auditing.

**Global Authority**: All agents operating in AFI Protocol repos must follow `afi-config/codex/governance/droids/AFI_DROID_CHARTER.v0.1.md`. If this AGENTS.md conflicts with the Charter, **the Charter wins**.

---

## Build & Test

```bash
# No build step required (artifacts are pre-compiled)
# Artifacts are generated by other repos and copied here

# Run reproducibility tests
npm test

# Run repro bundle checks
npm run test:repro

# Verify checksums
npm run test:checksums

# Test replay functionality
npm run test:replay
```

**Expected outcomes**: All checksums match, repro bundles are valid, replay tests pass.

---

## Run Locally / Dev Workflow

This repo is **output-first**, not source-first. Typical workflow:

1. Artifacts are generated by CI/CD or build processes in other repos
2. Artifacts are copied to this repo with checksums
3. Run `npm run test:checksums` to verify integrity
4. Commit artifacts with clear provenance metadata

**Do not manually edit compiled artifacts.**

---

## Architecture Overview

**Purpose**: Store and version compiled artifacts for reproducibility and auditing.

**Key directories**:
- `repro/` — Reproducibility bundles and test scripts
- `SHA256SUMS` — Checksum file for artifact verification
- `tests/` — Replay and validation tests

**Consumed by**: CI/CD pipelines, deployment workflows, audit processes.

---

## Security

- **Artifact integrity**: All artifacts must have SHA256 checksums.
- **No manual edits**: Artifacts are generated by automated processes. Manual edits break reproducibility.
- **Provenance tracking**: Each artifact should have metadata (source commit, build timestamp, builder).
- **No secrets**: Artifacts should not contain API keys, private keys, or credentials.

---

## Git Workflows

- **Base branch**: `main` or `migration/multi-repo-reorg`
- **Branch naming**: `feat/`, `fix/`, `chore/`
- **Commit messages**: Conventional commits (e.g., `chore(artifacts): add v0.2.0 build outputs`)
- **Before committing**: Run `npm run test:checksums` to verify integrity

---

## Conventions & Patterns

- **Artifact naming**: Include version and platform (e.g., `afi-core-v0.2.0-linux-x64.tar.gz`)
- **Checksums**: Always include SHA256SUMS file
- **Metadata**: Include build provenance (commit hash, timestamp, builder)
- **Repro bundles**: Follow existing structure in `repro/`

---

## Scope & Boundaries for Agents

**Allowed**:
- Add new artifacts when a spec explicitly calls for them
- Update checksums when artifacts change
- Add repro tests for new artifact types
- Improve documentation on artifact usage

**Forbidden**:
- "Cleaning up" or refactoring artifacts without clear reason
- Reformatting or renaming files just for aesthetics
- Manually editing compiled binaries or outputs
- Removing checksums or provenance metadata
- Adding artifacts without clear source and build process

**When unsure**: Ask for explicit spec on what artifacts to add and how they were generated. Prefer no-op over risky changes.

---

**Last Updated**: 2025-11-26  
**Maintainers**: AFI Ops Team  
**Charter**: `afi-config/codex/governance/droids/AFI_DROID_CHARTER.v0.1.md`

